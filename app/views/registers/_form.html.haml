%form.form-horizontal{role: "form"}

= simple_form_for @register, html: { class: 'form-horizontal form-register', role: 'form' }, defaults: { input_html: { class: 'form-control' } }  do |f|
  .form-group
    .col-sm-8
    = f.label :code, class: "col-sm-2"
    .col-sm-2
      %input.integer.optional.form-control{ readonly: true, type: "text", value: f.object.try(:code)  }
    = f.hidden_field :user_id

  = f.error_notification

  = render "owner", f: f

  .well
    .form-group
      .field
        = f.label :manager_type, class: "col-sm-7"
        .col-sm-2.control
          = f.input_field :manager_type_id, as: :select, collection: ManagerType.all, field: "manager_type" 
          %span.help-block.hidden

  .form-actions
    %legend IDENTIFICACIÓN DE LOS TITULARES
    = render 'holder', f: f

  = render "register_steps/form_submit", register: @register

.form-actions.navsteps 
  %a.btn.btn-primary.btn-large{ href: registers_path }
    .glyphicon.glyphicon-chevron-left
    Atrás
  - unless @register.new_record?
    %a.btn.btn-primary.btn-large.pull-right{ href: register_register_step_path(@register, :family) }
      Siguiente
      .glyphicon.glyphicon-chevron-right

:javascript
  var register = new Runpa.Views.Registers.NewView()
  var view = new Runpa.Views.Registers.NewHolder({
      el: 'form',
      model: new Runpa.Models.Holder({ 
        manager_type: "#{ @register.try(:manager_type_id) }", 
        holder_name: "#{ @register.try(:holder_main).try(:name) }",
        holder_lastname: "#{ @register.try(:holder_main).try(:first_lastname) }",
        holder_1_time_land: "#{ @register.try(:holders).try(:first).try(:time_to_land) }",
        holder_2_time_land: "#{ @register.try(:holders).try(:last).try(:time_to_land) }"
      })
  });
  view.render();